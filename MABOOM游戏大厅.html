<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MABOOM æ¸¸æˆä¸­å¿ƒ</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
  <style>
    body { margin: 0; padding: 10px; font-family: Arial; text-align: center; color: white; background: #120136; }
    h1 { font-size: 32px; margin: 20px; }
    .tab-button { display: block; width: 90%; margin: 20px auto; padding: 20px; font-size: 24px; background: #FFD700; color: #000; border-radius: 15px; cursor: pointer; }
    .game-section { display: none; min-height: 100vh; padding: 20px; }
    .active { display: block; }
    .back-btn { background: #333; position: fixed; top: 10px; left: 10px; z-index: 999; padding: 10px; border-radius: 10px; cursor: pointer; }
    button { padding: 12px 25px; margin: 10px; font-size: 18px; background: #e94560; border: none; border-radius: 10px; color: white; cursor: pointer; }
  </style>
</head>
<body>
  <h1>ğŸ® MABOOM æ¸¸æˆä¸­å¿ƒ</h1>
  <p>é€‰æ‹©æ¸¸æˆå¼€å§‹ç©ï¼Œèµšé©¬å¸é¢†$MABOOMç©ºæŠ•ï¼</p>

  <div class="tab-button" onclick="openGame('click')">ğŸ ç‚¹å‡»ç‹¬è§’å…½</div>
  <div class="tab-button" onclick="openGame('poker')">â™ ï¸ Pokerç‹è€…</div>
  <div class="tab-button" onclick="openGame('casino')">ğŸ° èµŒåœºè€è™æœºç™¾å®¶ä¹</div>
  <div class="tab-button" onclick="openGame('runner')">ğŸ é©¬äº†ä¸ªé©¬è·‘é…·</div>
  <div class="tab-button" onclick="openGame('farm')">ğŸŒ¾ å†œåœºè°·</div>

  <!-- ç‚¹å‡»ç‹¬è§’å…½æ¸¸æˆ -->
  <div id="click" class="game-section">
    <button class="back-btn" onclick="openGame('home')">è¿”å›å¤§å…</button>
    <style>
      #click { background: linear-gradient(#228B22, #006400); }
      #click_horse { font-size: 150px; cursor: pointer; transition: transform 0.1s; user-select: none; }
      #click_horse:active { transform: scale(0.9); }
      #click_score { font-size: 40px; margin: 20px; }
      #click button { background: #FF4500; }
    </style>
    <h1>ğŸ MABOOM é©¬å¹´å†²åˆº 2026 ğŸ’¥</h1>
    <p>ç‹‚ç‚¹ç¥é©¬ç§¯ç´¯é©¬åŠ›ï¼Œæ¢$MABOOMç©ºæŠ•ï¼</p>
    <img id="click_horse" src="https://i.imgur.com/hmUAPzg.jpeg" onclick="click_clickHorse()" style="width:380px; cursor:pointer;">
    <div id="click_score">é©¬åŠ›èƒ½é‡: 0</div>
    <button onclick="click_connectWallet()">è¿æ¥TONé’±åŒ…</button>
    <button onclick="click_useMaboom()">ç”¨$MABOOMåŠ é€Ÿ x3</button>
    <button onclick="click_claimReward()">é¢†å–MABOOMå¥–åŠ±</button>
    <script>
      let click_score = 0;
      let click_multiplier = 1;
      const click_tonConnectUI = new TONConnectUI({
        manifestUrl: 'https://ton-connect.github.io/demo-dapp-with-react/manifest.json'
      });
      function click_clickHorse() {
        click_score += 1 * click_multiplier;
        document.getElementById('click_score').innerText = 'é©¬åŠ›èƒ½é‡: ' + click_score;
        Telegram.WebApp.HapticFeedback.impactOccurred('heavy');
      }
      async function click_connectWallet() {
        try {
          await click_tonConnectUI.connectWallet();
          alert('TONé’±åŒ…è¿æ¥æˆåŠŸï¼å‡†å¤‡å†²åˆºğŸ');
        } catch(e) {
          alert('è¿æ¥å–æ¶ˆæˆ–å‡ºé”™ï¼Œå†è¯•ä¸€æ¬¡');
        }
      }
      function click_useMaboom() {
        click_multiplier = 3;
        setTimeout(() => { click_multiplier = 1; alert('MABOOMåŠ é€Ÿç»“æŸï¼Œç»§ç»­å†²ï¼'); }, 60000);
        alert('MABOOMé©¬åŠ›æ³¨å…¥ï¼æ¥ä¸‹æ¥60ç§’ä¸‰å€èƒ½é‡ğŸ”¥ğŸ’¨');
      }
      function click_claimReward() {
        if (click_score >= 10000) {
          click_score -= 10000;
          document.getElementById('click_score').innerText = 'é©¬åŠ›èƒ½é‡: ' + click_score;
          alert('ğŸ‰ å†²åˆºæˆåŠŸï¼å·²è§¦å‘MABOOMç©ºæŠ•ï¼\nè¯·åŠ å…¥å®˜æ–¹ç¾¤æäº¤é’±åŒ…åœ°å€é¢†å–ğŸ’°');
        } else {
          alert('è¿˜éœ€è¦ ' + (10000 - click_score) + ' é©¬åŠ›æ‰èƒ½é¢†å¥–åŠ±ï¼ç»§ç»­ç‚¹ç¥é©¬ğŸ');
        }
      }
    </script>
  </div>

  <!-- Pokerç‹è€… -->
  <div id="poker" class="game-section">
    <button class="back-btn" onclick="openGame('home')">è¿”å›å¤§å…</button>
    <style>
      #poker { background: #1a1a2e; }
      #poker .card { display: inline-block; width: 60px; height: 80px; background: #fff; border: 2px solid #000; border-radius: 5px; margin: 2px; font-size: 20px; line-height: 80px; }
      #poker .hand { margin: 10px; }
      #poker_score { font-size: 28px; margin: 15px; }
      #poker button { background: #e94560; }
    </style>
    <h1>â™ ï¸ MABOOM Pokerç‹è€…</h1>
    <div id="poker_score">å¸: 1000</div>
    <div id="poker_game">
      <div id="poker_player-hand" class="hand">ä½ çš„æ‰‹ç‰Œ: </div>
      <div id="poker_community">å…¬å…±ç‰Œ: </div>
      <div id="poker_ai-hand" class="hand">AIæ‰‹ç‰Œ: [éšè—]</div>
      <button onclick="poker_startGame()">æ–°æ¸¸æˆ</button>
      <button onclick="poker_betAndDeal()">ä¸‹æ³¨&å‘ç‰Œ</button>
      <button onclick="poker_revealAndScore()">æ­ç‰Œ&ç»“ç®—</button>
      <button onclick="poker_submitScore()">æäº¤åˆ†æ•°ä¸Šæ’è¡Œæ¦œ</button>
    </div>
    <div id="poker_leaderboard"></div>
    <script>
      let poker_coins = parseInt(localStorage.getItem('maboomPokerCoins') || '1000');
      let poker_playerHand = [];
      let poker_aiHand = [];
      let poker_communityCards = [];
      let poker_suits = ['â™ ï¸', 'â™¥ï¸', 'â™¦ï¸', 'â™£ï¸'];
      let poker_ranks = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];
      document.getElementById('poker_score').innerText = 'å¸: ' + poker_coins;

      function poker_evaluateHand(hand) {
        hand.sort((a, b) => poker_ranks.indexOf(a.rank) - poker_ranks.indexOf(b.rank));
        let sameSuit = hand.every(card => card.suit === hand[0].suit);
        let straight = hand.length === 5 && hand.every((card, i) => i === 0 || poker_ranks.indexOf(card.rank) === poker_ranks.indexOf(hand[i-1].rank) + 1);
        if (sameSuit && straight) return 9;
        let counts = {};
        hand.forEach(card => counts[card.rank] = (counts[card.rank] || 0) + 1);
        if (Object.values(counts).includes(4)) return 8;
        if (Object.values(counts).includes(3) && Object.values(counts).includes(2)) return 7;
        if (sameSuit) return 6;
        if (straight) return 5;
        if (Object.values(counts).includes(3)) return 4;
        if (Object.values(counts).filter(c => c === 2).length === 2) return 3;
        if (Object.values(counts).includes(2)) return 2;
        return 1;
      }

      function poker_dealCard() {
        let suit = poker_suits[Math.floor(Math.random() * 4)];
        let rank = poker_ranks[Math.floor(Math.random() * 13)];
        return { suit, rank };
      }

      function poker_startGame() {
        poker_coins = 1000;
        poker_playerHand = [poker_dealCard(), poker_dealCard()];
        poker_aiHand = [poker_dealCard(), poker_dealCard()];
        poker_communityCards = [];
        poker_updateDisplay();
        document.getElementById('poker_score').innerText = 'å¸: ' + poker_coins;
      }

      function poker_betAndDeal() {
        if (poker_coins < 100) { alert('å¸ä¸å¤Ÿï¼'); return; }
        poker_coins -= 100;
        poker_communityCards = [poker_dealCard(), poker_dealCard(), poker_dealCard()];
        poker_updateDisplay();
        document.getElementById('poker_score').innerText = 'å¸: ' + poker_coins;
      }

      function poker_revealAndScore() {
        poker_communityCards.push(poker_dealCard(), poker_dealCard());
        let playerFull = [...poker_playerHand, ...poker_communityCards];
        let aiFull = [...poker_aiHand, ...poker_communityCards];
        let playerScore = poker_evaluateHand(playerFull.slice(0,5));
        let aiScore = poker_evaluateHand(aiFull.slice(0,5));
        let win = playerScore > aiScore ? 1 : (playerScore < aiScore ? -1 : 0);
        if (win > 0) { poker_coins += 300; alert('èµ¢äº†ï¼+300å¸'); }
        else if (win < 0) { alert('è¾“äº†ï¼-100å¸'); poker_coins -= 100; }
        else { poker_coins += 100; alert('å¹³å±€ï¼+100å¸'); }
        poker_updateDisplay(true);
        document.getElementById('poker_score').innerText = 'å¸: ' + poker_coins;
      }

      function poker_updateDisplay(revealAI = false) {
        let playerHtml = poker_playerHand.map(c => `<span class="card">${c.rank}${c.suit}</span>`).join('');
        document.getElementById('poker_player-hand').innerHTML = 'ä½ çš„æ‰‹ç‰Œ: ' + playerHtml;
        let communityHtml = poker_communityCards.map(c => `<span class="card">${c.rank}${c.suit}</span>`).join('');
        document.getElementById('poker_community').innerHTML = 'å…¬å…±ç‰Œ: ' + communityHtml;
        let aiHtml = revealAI ? poker_aiHand.map(c => `<span class="card">${c.rank}${c.suit}</span>`).join('') : '[éšè—]';
        document.getElementById('poker_ai-hand').innerHTML = 'AIæ‰‹ç‰Œ: ' + aiHtml;
      }

      function poker_submitScore() {
        const name = prompt('è¾“å…¥åå­—ä¸Šæ’è¡Œæ¦œ: ', 'ç©å®¶');
        if (name && poker_coins > 0) {
          let lb = JSON.parse(localStorage.getItem('maboomPokerLB') || '[]');
          lb.push({ name, coins: poker_coins });
          lb.sort((a, b) => b.coins - a.coins);
          lb = lb.slice(0, 10);
          localStorage.setItem('maboomPokerLB', JSON.stringify(lb));
          alert('æäº¤æˆåŠŸï¼ä½ çš„å¸: ' + poker_coins);
          poker_showLeaderboard();
        }
      }

      function poker_showLeaderboard() {
        const lb = JSON.parse(localStorage.getItem('maboomPokerLB') || '[]');
        let html = '<h3>ğŸ† æ’è¡Œæ¦œ (å¸æ•°)</h3><table><tr><th>æ’å</th><th>ç©å®¶</th><th>å¸</th></tr>';
        lb.forEach((item, i) => html += `<tr><td>${i+1}</td><td>${item.name}</td><td>${item.coins}</td></tr>`);
        html += '</table>';
        document.getElementById('poker_leaderboard').innerHTML = html;
      }

      poker_startGame();
    </script>
  </div>

  <!-- èµŒåœºè€è™æœºç™¾å®¶ä¹ -->
  <div id="casino" class="game-section">
    <button class="back-btn" onclick="openGame('home')">è¿”å›å¤§å…</button>
    <style>
      #casino { background: #120136; color: gold; }
      #casino_coins { font-size: 30px; margin: 20px; }
      #casino .game-section { margin: 30px; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 15px; }
      #casino #slotMachine { display: flex; justify-content: center; align-items: center; gap: 10px; }
      #casino .reel { width: 100px; height: 100px; background: #fff; color: #000; font-size: 60px; line-height: 100px; border-radius: 10px; }
      #casino button { padding: 15px 30px; margin: 10px; font-size: 20px; background: #FFD700; color: #000; border: none; border-radius: 10px; cursor: pointer; }
      #casino .baccarat-btn { background: #32CD32; }
      #casino .baccarat-btn.player { background: #1E90FF; }
      #casino .baccarat-btn.tie { background: #FFA500; }
    </style>
    <h1>ğŸ° MABOOM èµŒåœºç‹è€…</h1>
    <p>è€è™æœºè½¬èµ·æ¥ï¼Œç™¾å®¶ä¹ä¸‹æ³¨èµ¢å¤§å¥–ï¼èµšå¸é¢†$MABOOMç©ºæŠ•ï¼</p>
    <div id="casino_coins">é©¬å¸: 1000</div>

    <!-- è€è™æœº -->
    <div class="game-section">
      <h2>ğŸ° è€è™æœº (ä¸‹æ³¨100å¸)</h2>
      <div id="casino_slotMachine">
        <div class="reel" id="casino_reel1">?</div>
        <div class="reel" id="casino_reel2">?</div>
        <div class="reel" id="casino_reel3">?</div>
      </div>
      <button onclick="casino_playSlot()">æ‹‰æ†ï¼(-100å¸)</button>
    </div>

    <!-- ç™¾å®¶ä¹ -->
    <div class="game-section">
      <h2>ğŸƒ ç™¾å®¶ä¹ (ä¸‹æ³¨100å¸)</h2>
      <p>ç©å®¶æ‰‹ç‰Œ: <span id="casino_playerCards">-</span></p>
      <p>åº„å®¶æ‰‹ç‰Œ: <span id="casino_bankerCards">-</span></p>
      <p id="casino_result"></p>
      <button class="baccarat-btn player" onclick="casino_betBaccarat('player')">ä¸‹æ³¨ç©å®¶ (èµ”ç‡1:1)</button>
      <button class="baccarat-btn" onclick="casino_betBaccarat('banker')">ä¸‹æ³¨åº„å®¶ (èµ”ç‡1:0.95)</button>
      <button class="baccarat-btn tie" onclick="casino_betBaccarat('tie')">ä¸‹æ³¨å’Œ (èµ”ç‡1:8)</button>
    </div>

    <button onclick="casino_showLeaderboard()">æŸ¥çœ‹æ’è¡Œæ¦œ</button>
    <div id="casino_leaderboard"></div>
    <script>
      let casino_coins = parseInt(localStorage.getItem('maboomCasinoCoins') || '1000');
      document.getElementById('casino_coins').innerText = 'é©¬å¸: ' + casino_coins;
      const casino_symbols = ['ğŸ’', 'ğŸ‹', 'ğŸŠ', '7ï¸âƒ£', 'ğŸ’', 'ğŸƒ', 'ğŸ°', 'â­'];

      function casino_playSlot() {
        if (casino_coins < 100) { alert('é©¬å¸ä¸è¶³ï¼'); return; }
        casino_coins -= 100;
        casino_updateCoins();
        const reels = [document.getElementById('casino_reel1'), document.getElementById('casino_reel2'), document.getElementById('casino_reel3')];
        reels.forEach(reel => reel.innerText = 'ğŸ°');
        setTimeout(() => {
          const result = [casino_getRandomSymbol(), casino_getRandomSymbol(), casino_getRandomSymbol()];
          reels.forEach((reel, i) => reel.innerText = result[i]);
          const win = casino_checkSlotWin(result);
          if (win > 0) {
            casino_coins += win;
            alert(`æ­å–œä¸­å¥–ï¼+${win}é©¬å¸`);
          } else {
            alert('æœªä¸­å¥–ï¼Œå†æ¥ä¸€æ¬¡ï¼');
          }
          casino_updateCoins();
        }, 2000);
      }

      function casino_getRandomSymbol() {
        return casino_symbols[Math.floor(Math.random() * casino_symbols.length)];
      }

      function casino_checkSlotWin(result) {
        if (result[0] === result[1] && result[1] === result[2]) {
          return result[0] === '7ï¸âƒ£' ? 1000 : result[0] === 'ğŸ’' ? 800 : 500;
        }
        return 0;
      }

      function casino_betBaccarat(betType) {
        if (casino_coins < 100) { alert('é©¬å¸ä¸è¶³ï¼'); return; }
        casino_coins -= 100;
        casino_updateCoins();
        casino_playerCards = [casino_dealCard(), casino_dealCard()];
        casino_bankerCards = [casino_dealCard(), casino_dealCard()];
        document.getElementById('casino_playerCards').innerText = casino_formatCards(casino_playerCards);
        document.getElementById('casino_bankerCards').innerText = casino_formatCards(casino_bankerCards);
        const winner = casino_determineBaccaratWinner();
        let payout = 0;
        if (betType === winner) {
          payout = betType === 'player' ? 200 : betType === 'banker' ? 195 : 900;
          casino_coins += payout;
          alert(`ä½ èµ¢äº†ï¼+${payout}é©¬å¸`);
        } else if (winner === 'tie' && betType === 'tie') {
          casino_coins += 900;
          alert('å’Œå±€ä¸­å¥–ï¼+900é©¬å¸');
        } else {
          alert('è¾“äº†ï¼Œå†æ¥å†å‰ï¼');
        }
        casino_updateCoins();
      }

      function casino_dealCard() {
        const rank = Math.floor(Math.random() * 13) + 1;
        return { value: rank > 10 ? 0 : rank, name: ['A','2','3','4','5','6','7','8','9','10','J','Q','K'][rank-1] };
      }

      function casino_formatCards(cards) {
        return cards.map(c => c.name).join(' ');
      }

      function casino_determineBaccaratWinner() {
        let playerTotal = (casino_playerCards[0].value + casino_playerCards[1].value) % 10;
        let bankerTotal = (casino_bankerCards[0].value + casino_bankerCards[1].value) % 10;
        if (playerTotal > bankerTotal) return 'player';
        if (bankerTotal > playerTotal) return 'banker';
        return 'tie';
      }

      function casino_updateCoins() {
        document.getElementById('casino_coins').innerText = 'é©¬å¸: ' + casino_coins;
        localStorage.setItem('maboomCasinoCoins', casino_coins);
      }

      function casino_showLeaderboard() {
        let lb = JSON.parse(localStorage.getItem('maboomCasinoLB') || '[]');
        lb.push({ name: prompt('ä¸Šæ’è¡Œæ¦œè¾“å…¥åå­—:', 'èµŒç‹') || 'åŒ¿å', coins: casino_coins });
        lb.sort((a, b) => b.coins - a.coins);
        lb = lb.slice(0, 10);
        localStorage.setItem('maboomCasinoLB', JSON.stringify(lb));
        let html = '<h3>ğŸ† èµŒåœºæ’è¡Œæ¦œ (æ€»é©¬å¸)</h3><table><tr><th>æ’å</th><th>ç©å®¶</th><th>é©¬å¸</th></tr>';
        lb.forEach((item, i) => html += `<tr><td>${i+1}</td><td>${item.name}</td><td>${item.coins}</td></tr>`);
        html += '</table>';
        document.getElementById('casino_leaderboard').innerHTML = html;
      }
    </script>
  </div>

  <!-- é©¬äº†ä¸ªé©¬è·‘é…· -->
  <div id="runner" class="game-section">
    <button class="back-btn" onclick="openGame('home')">è¿”å›å¤§å…</button>
    <style>
      #runner { background: #87CEEB; overflow: hidden; position: relative; }
      #runner_gameContainer { position: relative; width: 100vw; height: 100vh; }
      #runner_ground { position: absolute; bottom: 0; width: 200%; height: 20px; background: #228B22; animation: moveGround 4s linear infinite; }
      @keyframes moveGround { from { transform: translateX(0); } to { transform: translateX(-50%); } }
      #runner_horse { position: absolute; bottom: 20px; left: 50px; width: 80px; height: 80px; font-size: 60px; transition: bottom 0.5s; }
      .runner_obstacle { position: absolute; bottom: 20px; right: 0; width: 40px; height: 60px; background: #8B4513; border-radius: 10px; animation: moveObstacle 3s linear infinite; }
      @keyframes moveObstacle { from { right: 0; } to { right: 100%; } }
      #runner_score { position: absolute; top: 20px; left: 20px; font-size: 24px; }
      #runner_coins { position: absolute; top: 20px; right: 20px; font-size: 24px; }
      #runner_menu { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 10; }
      #runner_shop, #runner_leaderboard { margin: 20px; }
    </style>
    <div id="runner_gameContainer">
      <div id="runner_score">è·ç¦»: 0</div>
      <div id="runner_coins">é©¬å¸: 0</div>
      <div id="runner_horse">ğŸ</div>
      <div id="runner_ground"></div>
    </div>

    <div id="runner_menu">
      <h1>é©¬äº†ä¸ªé©¬ - MABOOMè·‘é…·ç‹</h1>
      <p>ç‚¹å‡»å±å¹•è®©é©¬è·³è·ƒï¼Œèº²éšœç¢èµšé©¬å¸ï¼</p>
      <button onclick="runner_startGame()">å¼€å§‹æ¸¸æˆ</button>
      <button onclick="runner_checkIn()">æ¯æ—¥ç­¾åˆ°</button>
      <button onclick="runner_openShop()">çš®è‚¤å•†åº—</button>
      <button onclick="runner_showLeaderboard()">æ’è¡Œæ¦œ</button>
      <div id="runner_shop" style="display:none;">
        <p>é€‰æ‹©çš®è‚¤ï¼ˆæ¶ˆè€—é©¬å¸ï¼‰</p>
        <div class="skin" onclick="runner_buySkin('ğŸ',0)">ğŸ åŸç‰ˆ (å…è´¹)</div>
        <div class="skin" onclick="runner_buySkin('ğŸ¦„',500)">ğŸ¦„ ç‹¬è§’å…½ (500å¸)</div>
        <div class="skin" onclick="runner_buySkin('ğŸ‡',1000)">ğŸ‡ èµ›é©¬ (1000å¸)</div>
        <div class="skin" onclick="runner_buySkin('ğŸ”´',1500)">ğŸ”´ çº¢é»‘é©¬ (1500å¸)</div>
        <button onclick="runner_openShop(false)">å…³é—­å•†åº—</button>
      </div>
      <div id="runner_leaderboard" style="display:none;"></div>
    </div>

    <script>
      let runner_score = 0;
      let runner_coins = parseInt(localStorage.getItem('maboomRunnerCoins') || '0');
      let runner_currentSkin = localStorage.getItem('maboomRunnerSkin') || 'ğŸ';
      let runner_gameRunning = false;
      let runner_horseElement = document.getElementById('runner_horse');
      let runner_gameContainer = document.getElementById('runner_gameContainer');
      let runner_menu = document.getElementById('runner_menu');
      let runner_lastCheckIn = localStorage.getItem('maboomRunnerLastCheckIn');

      document.getElementById('runner_coins').innerText = 'é©¬å¸: ' + runner_coins;
      runner_horseElement.innerText = runner_currentSkin;

      function runner_startGame() {
        if (runner_gameRunning) return;
        runner_gameRunning = true;
        runner_menu.style.display = 'none';
        runner_score = 0;
        document.getElementById('runner_score').innerText = 'è·ç¦»: 0';
        runner_createObstacle();
        setInterval(() => {
          if (runner_gameRunning) runner_score += 1;
          document.getElementById('runner_score').innerText = 'è·ç¦»: ' + runner_score;
        }, 100);
      }

      function runner_jump() {
        if (!runner_gameRunning) return;
        runner_horseElement.style.bottom = '120px';
        setTimeout(() => runner_horseElement.style.bottom = '20px', 500);
        Telegram.WebApp.HapticFeedback.impactOccurred('light');
      }

      function runner_createObstacle() {
        if (!runner_gameRunning) return;
        const obs = document.createElement('div');
        obs.classList.add('runner_obstacle');
        runner_gameContainer.appendChild(obs);
        setTimeout(() => obs.remove(), 6000);
        setTimeout(runner_createObstacle, Math.random() * 2000 + 2000);
      }

      function runner_checkCollision() {
        if (!runner_gameRunning) return;
        const horseRect = runner_horseElement.getBoundingClientRect();
        document.querySelectorAll('.runner_obstacle').forEach(obs => {
          const obsRect = obs.getBoundingClientRect();
          if (horseRect.right > obsRect.left && horseRect.left < obsRect.right &&
              horseRect.bottom > obsRect.top && horseRect.top < obsRect.bottom) {
            runner_gameOver();
          }
        });
      }

      function runner_gameOver() {
        runner_gameRunning = false;
        runner_coins += Math.floor(runner_score / 10);
        localStorage.setItem('maboomRunnerCoins', runner_coins);
        document.getElementById('runner_coins').innerText = 'é©¬å¸: ' + runner_coins;
        runner_submitScoreToLeaderboard(runner_score);
        alert(`æ¸¸æˆç»“æŸï¼æœ¬æ¬¡è·ç¦»: ${runner_score}\nè·å¾—é©¬å¸: ${Math.floor(runner_score / 10)}`);
        runner_menu.style.display = 'flex';
        runner_openShop(false);
      }

      function runner_checkIn() {
        const today = new Date().toDateString();
        if (runner_lastCheckIn !== today) {
          runner_coins += 100;
          localStorage.setItem('maboomRunnerCoins', runner_coins);
          localStorage.setItem('maboomRunnerLastCheckIn', today);
          document.getElementById('runner_coins').innerText = 'é©¬å¸: ' + runner_coins;
          alert('ç­¾åˆ°æˆåŠŸï¼+100é©¬å¸');
        } else {
          alert('ä»Šå¤©å·²ç­¾åˆ°ï¼Œæ˜å¤©å†æ¥ï¼');
        }
      }

      function runner_buySkin(skin, price) {
        if (runner_coins >= price) {
          runner_coins -= price;
          runner_currentSkin = skin;
          localStorage.setItem('maboomRunnerCoins', runner_coins);
          localStorage.setItem('maboomRunnerSkin', skin);
          document.getElementById('runner_coins').innerText = 'é©¬å¸: ' + runner_coins;
          runner_horseElement.innerText = skin;
          alert('è´­ä¹°æˆåŠŸï¼æ–°çš®è‚¤å·²è£…å¤‡');
        } else {
          alert('é©¬å¸ä¸è¶³ï¼å¤šç©å‡ å±€èµšå¸å§');
        }
      }

      function runner_openShop(show = true) {
        document.getElementById('runner_shop').style.display = show ? 'block' : 'none';
      }

      function runner_submitScoreToLeaderboard(score) {
        let lb = JSON.parse(localStorage.getItem('maboomRunnerLB') || '[]');
        const name = prompt('ä¸Šæ’è¡Œæ¦œè¾“å…¥åå­—:', 'é©¬ç‹');
        if (name) {
          lb.push({ name, score });
          lb.sort((a, b) => b.score - a.score);
          lb = lb.slice(0, 10);
          localStorage.setItem('maboomRunnerLB', JSON.stringify(lb));
        }
      }

      function runner_showLeaderboard() {
        const lb = JSON.parse(localStorage.getItem('maboomRunnerLB') || '[]');
        let html = '<h3>ğŸ† æ’è¡Œæ¦œ - æœ€è¿œè·ç¦»</h3><table><tr><th>æ’å</th><th>ç©å®¶</th><th>è·ç¦»</th></tr>';
        lb.forEach((item, i) => html += `<tr><td>${i+1}</td><td>${item.name}</td><td>${item.score}</td></tr>`);
        html += '</table><button onclick="runner_menu.style.display=\'flex\';document.getElementById(\'runner_leaderboard\').style.display=\'none\';">è¿”å›</button>';
        document.getElementById('runner_leaderboard').innerHTML = html;
        document.getElementById('runner_leaderboard').style.display = 'block';
      }

      runner_gameContainer.addEventListener('click', runner_jump);
      setInterval(runner_checkCollision, 50);
    </script>
  </div>

  <!-- å†œåœºè°· -->
  <div id="farm" class="game-section">
    <button class="back-btn" onclick="openGame('home')">è¿”å›å¤§å…</button>
    <style>
      #farm { background: #90EE90; color: #333; }
      #farm_coins { font-size: 26px; margin: 15px; }
      #farm_farm { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; max-width: 400px; margin: 20px auto; }
      .farm_plot { width: 100px; height: 100px; background: #8B4513; border: 3px solid #654321; border-radius: 10px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 40px; position: relative; }
      .farm_plot.growing { background: #228B22; color: white; }
      .farm_plot.ready { background: #FFD700; color: #333; }
      .farm_plot.locked { background: #A9A9A9; cursor: not-allowed; }
      #farm button { background: #32CD32; }
      #farm_shop { margin: 20px; }
    </style>
    <h1>ğŸŒ¾ MABOOM å†œåœºè°·</h1>
    <p>ç§åœ°æ”¶è·èµšé©¬å¸ï¼Œé«˜åˆ†ä¸Šæ’è¡Œæ¦œé¢†ç©ºæŠ•ï¼</p>
    <div id="farm_coins">é©¬å¸: 1000</div>
    <div id="farm_farm"></div>

    <button onclick="farm_checkIn()">æ¯æ—¥ç­¾åˆ°</button>
    <button onclick="farm_openShop()">å•†åº—ä¹°ç§å­/å·¥å…·</button>
    <button onclick="farm_showLeaderboard()">æŸ¥çœ‹æ’è¡Œæ¦œ</button>

    <div id="farm_shop" style="display:none;">
      <h3>å•†åº—</h3>
      <p>ç‰ç±³ç§å­: 50å¸ <button onclick="farm_buySeed('ç‰ç±³', 50)">ä¹°</button></p>
      <p>èƒ¡èåœç§å­: 80å¸ <button onclick="farm_buySeed('èƒ¡èåœ', 80)">ä¹°</button></p>
      <p>å‡çº§å·¥å…·: 200å¸ <button onclick="farm_upgradeTool()">å‡çº§</button></p>
      <button onclick="farm_openShop(false)">å…³é—­</button>
    </div>

    <div id="farm_leaderboard" style="display:none;"></div>

    <script>
      let farm_coins = parseInt(localStorage.getItem('maboomFarmCoins') || '1000');
      let farm_plots = JSON.parse(localStorage.getItem('maboomFarmPlots') || '[{"state":"empty"},{"state":"empty"},{"state":"empty"},{"state":"empty"},{"state":"empty"},{"state":"empty"},{"state":"empty"},{"state":"empty"},{"state":"empty"}]');
      let farm_currentSeed = 'ç‰ç±³';
      let farm_toolLevel = parseInt(localStorage.getItem('maboomToolLevel') || '1');
      let farm_lastCheckIn = localStorage.getItem('maboomLastCheckIn');

      document.getElementById('farm_coins').innerText = 'é©¬å¸: ' + farm_coins;
      farm_renderFarm();

      function farm_renderFarm() {
        const farm = document.getElementById('farm_farm');
        farm.innerHTML = '';
        farm_plots.forEach((plot, i) => {
          const div = document.createElement('div');
          div.classList.add('farm_plot');
          if (plot.state === 'growing') {
            div.classList.add('growing');
            div.innerText = 'ğŸŒ±';
            div.onclick = () => alert('ä½œç‰©æˆé•¿ä¸­...');
          } else if (plot.state === 'ready') {
            div.classList.add('ready');
            div.innerText = plot.crop === 'ç‰ç±³' ? 'ğŸŒ½' : 'ğŸ¥•';
            div.onclick = () => farm_harvest(i);
          } else {
            div.onclick = () => farm_plant(i);
          }
          farm.appendChild(div);
        });
      }

      function farm_plant(index) {
        if (farm_plots[index].state !== 'empty') return;
        farm_plots[index].state = 'growing';
        farm_plots[index].crop = farm_currentSeed;
        farm_plots[index].time = Date.now() + 10000 / farm_toolLevel;
        localStorage.setItem('maboomFarmPlots', JSON.stringify(farm_plots));
        farm_renderFarm();
        setTimeout(() => {
          if (farm_plots[index] && farm_plots[index].time <= Date.now()) {
            farm_plots[index].state = 'ready';
            localStorage.setItem('maboomFarmPlots', JSON.stringify(farm_plots));
            farm_renderFarm();
          }
        }, 10000 / farm_toolLevel);
      }

      function farm_harvest(index) {
        if (farm_plots[index].state !== 'ready') return;
        farm_coins += farm_plots[index].crop === 'ç‰ç±³' ? 200 : 300;
        farm_updateCoins();
        farm_plots[index].state = 'empty';
        localStorage.setItem('maboomFarmPlots', JSON.stringify(farm_plots));
        farm_renderFarm();
        alert(`æ”¶è·æˆåŠŸï¼+${farm_plots[index].crop === 'ç‰ç±³' ? 200 : 300}é©¬å¸`);
      }

      function farm_checkIn() {
        const today = new Date().toDateString();
        if (farm_lastCheckIn !== today) {
          farm_coins += 200;
          farm_updateCoins();
          localStorage.setItem('maboomLastCheckIn', today);
          alert('ç­¾åˆ°æˆåŠŸï¼+200é©¬å¸');
        } else {
          alert('ä»Šå¤©å·²ç­¾åˆ°ï¼Œæ˜å¤©å†æ¥ï¼');
        }
      }

      function farm_buySeed(crop, price) {
        if (farm_coins >= price) {
          farm_coins -= price;
          farm_currentSeed = crop;
          farm_updateCoins();
          alert(`è´­ä¹°æˆåŠŸï¼å½“å‰ç§å­: ${crop}`);
        } else {
          alert('é©¬å¸ä¸è¶³ï¼');
        }
      }

      function farm_upgradeTool() {
        const price = farm_toolLevel * 200;
        if (farm_coins >= price) {
          farm_coins -= price;
          farm_toolLevel++;
          localStorage.setItem('maboomToolLevel', farm_toolLevel);
          farm_updateCoins();
          alert(`å·¥å…·å‡çº§åˆ°Lv.${farm_toolLevel}ï¼æ”¶è·æ›´å¿«`);
        } else {
          alert('é©¬å¸ä¸è¶³ï¼');
        }
      }

      function farm_updateCoins() {
        document.getElementById('farm_coins').innerText = 'é©¬å¸: ' + farm_coins;
        localStorage.setItem('maboomFarmCoins', farm_coins);
      }

      function farm_submitScoreToLeaderboard() {
        let lb = JSON.parse(localStorage.getItem('maboomFarmLB') || '[]');
        const name = prompt('ä¸Šæ’è¡Œæ¦œè¾“å…¥åå­—:', 'å†œåœºä¸»');
        if (name) {
          lb.push({ name, coins: farm_coins });
          lb.sort((a, b) => b.coins - a.coins);
          lb = lb.slice(0, 10);
          localStorage.setItem('maboomFarmLB', JSON.stringify(lb));
        }
      }

      function farm_showLeaderboard() {
        farm_submitScoreToLeaderboard();
        const lb = JSON.parse(localStorage.getItem('maboomFarmLB') || '[]');
        let html = '<h3>ğŸ† å†œåœºæ’è¡Œæ¦œ (æ€»é©¬å¸)</h3><table><tr><th>æ’å</th><th>ç©å®¶</th><th>é©¬å¸</th></tr>';
        lb.forEach((item, i) => html += `<tr><td>${i+1}</td><td>${item.name}</td><td>${item.coins}</td></tr>`);
        html += '</table>';
        document.getElementById('farm_leaderboard').innerHTML = html;
        document.getElementById('farm_leaderboard').style.display = 'block';
      }

      function farm_openShop(show = true) {
        document.getElementById('farm_shop').style.display = show ? 'block' : 'none';
      }
    </script>
  </div>

  <script>
    Telegram.WebApp.ready();
    Telegram.WebApp.expand();

    function openGame(id) {
      document.querySelectorAll('.game-section').forEach(sec => sec.classList.remove('active'));
      document.querySelectorAll('.tab-button').forEach(btn => btn.style.display = id === 'home' ? 'block' : 'none');
      if (id !== 'home') {
        document.getElementById(id).classList.add('active');
      }
    }

    openGame('home');
  </script>
</body>
</html>